# mediamtx.yml

paths:
  cam:
    source: rpiCamera
    # Use 2304x1728 for the widest possible 4:3 "un-cropped" view
    # Or 1536x1152 for a good balance of FOV and performance
    # rpiCameraWidth: 1280
    # rpiCameraHeight: 720
    # rpiCameraFPS: 60
    # Module 3 is very sharp; this helps with high-speed rover movement
    # rpiCameraBitrate: 4000000

    # 720p
    rpiCameraWidth: 1280
    rpiCameraHeight: 720
    rpiCameraFPS: 60
    # rpiCameraAfMode: continuous
    # rpiCameraAfRange: normal
    # # For driving, 'manual' with LensPosition 0.0 (infinity) is often more stable
    rpiCameraAfMode: manual
    rpiCameraLensPosition: 0.0

    # 1080p
    # rpiCameraWidth: 1920
    # rpiCameraHeight: 1080
    # rpiCameraFPS: 30
    # rpiCameraAfMode: continuous
    # rpiCameraBitrate: 6000000

    # 4K
    # rpiCameraWidth: 4608
    # rpiCameraHeight: 2592
    # rpiCameraFPS: 30
    # rpiCameraAfMode: continuous
    # rpiCameraBitrate: 6000000
    # If the image is upside down (common in rovers), uncomment the next line:
    # rpiCameraVFlip: yes

# WebRTC Server settings
webrtc: yes
webrtcAddress: :8889
webrtcEncryption: no
webrtcServerKey: server.key
webrtcServerCert: server.crt
webrtcAllowOrigins: ["*"]

# These replace the old ICEUDP settings
# UDP is the default and best for RC cars
webrtcLocalUDPAddress: :8189
# webrtcLocalTCPAddress: :8189 # Leave this commented out for ultra-low latency

# Crucial for Tailscale/Remote access
webrtcIPsFromInterfaces: yes
webrtcAdditionalHosts: [100.109.197.90] # Your Pi's Tailscale IP

# Added STUN server to help the browser find the Pi
webrtcICEServers2:
  - url: stun:stun.l.google.com:19302
